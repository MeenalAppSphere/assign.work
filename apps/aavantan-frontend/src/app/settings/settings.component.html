<!-- section 1 -->
<section id="settings-page">

  <ul class="setting-tab-btn">

    <li>
      <a href="javascript:void(0);" nz-button nzType="default" [ngClass]="{'active':activeView.view==='project'}" (click)="activeTab('project', 'Project')">
        <i class="fas fa-desktop"></i>
        Project
      </a>
    </li>

    <li>
      <a href="javascript:void(0);" nz-button nzType="default" [ngClass]="{'active':activeView.view==='collaborators'}"
         (click)="activeTab('collaborators', 'Collaborators')">
        <i class="fas fa-user-friends"></i>
        Collaborators
      </a>
    </li>

    <li>
      <a href="javascript:void(0);" nz-button nzType="default" [ngClass]="{'active':activeView.view==='stages'}"
         (click)="activeTab('stages', 'Stages')">
        <i class="fas fa-bars"></i>
        Stages
      </a>
    </li>

    <li>
      <a href="javascript:void(0);" nz-button nzType="default" [ngClass]="{'active':activeView.view==='status'}"
         (click)="activeTab('status', 'Status')">
        <i class="fas fa-battery-half"></i>
        Status
      </a>
    </li>

    <li>
      <a href="javascript:void(0);" nz-button nzType="default" [ngClass]="{'active':activeView.view==='priority'}"
         (click)="activeTab('priority', 'Priority')">
        <i class="fas fa-arrow-up"></i>
        Priority
      </a>
    </li>

    <li>
      <a href="javascript:void(0);" nz-button nzType="default" [ngClass]="{'active':activeView.view==='taskType'}"
         (click)="activeTab('taskType', 'Task Type')">
        <i class="fab fa-accusoft"></i>
        Task Type
      </a>
    </li>

    <li>
      <a href="javascript:void(0);" nz-button nzType="default" [ngClass]="{'active':activeView.view==='capacity'}" (click)="activeTab('capacity', 'Team Capacity')">
        <i class="fab fa-slideshare"></i>
        Team Capacity
      </a>
    </li>

  </ul>

  <section>

    <nz-card nzTitle="{{activeView.title}}" style="min-height:420px; overflow: scroll;">

      <ng-container *ngIf="activeView.view==='project'">
        <section class="row">
          <aside class="col-md-3">
            <form nz-form class="register-form" [formGroup]="projectForm">
              <nz-form-item>
                <nz-form-label>Project Title<span class="text-danger">*</span></nz-form-label>
                <input
                  autocomplete="Off"
                  formControlName="name"
                  placeholder="Project name"
                  nz-input nzSize="small">
              </nz-form-item>
              <nz-form-item>
                <button (click)="saveProject()" [nzLoading]="updateRequestInProcess" nz-button nzType="primary"
                        nzSize="small"> Save
                </button>
              </nz-form-item>
            </form>
          </aside>
        </section>
      </ng-container>

      <ng-container *ngIf="activeView.view==='collaborators'">
        <section class="row">
          <aside class="col-md-3">
            <form nz-form class="register-form" [formGroup]="collaboratorForm">
              <nz-form-item>
                <label>Search or Invite Collaborator</label>
                <input
                  autocomplete="Off"
                  type="email"
                  formControlName="collaborators"
                  [(ngModel)]="selectedCollaborator"
                  [typeaheadAsync]="true"
                  [typeahead]="userDataSource"
                  (typeaheadOnSelect)="typeaheadOnSelect($event)"
                  typeaheadOptionField="emailId"
                  placeholder="Search or Invite people"
                  (keydown)="onKeydown($event)"
                  nz-input nzSize="small">
              </nz-form-item>
              <nz-form-explain class="text-danger m-b-15"
                               *ngIf="response && response.message">{{response.message}}</nz-form-explain>
              <nz-form-item>
                <button (click)="addCollaborators()" [disabled]="!enableInviteBtn" nz-button nzType="primary"
                        nzSize="small">
                  <i nz-icon nzType="mail" theme="outline"></i> Invite
                </button>
              </nz-form-item>
              <p>Note: If user not available into list then you type email id and then invite them directly.</p>
            </form>
          </aside>
          <aside class="col-md-3">
            <nz-form-label>Collaborators</nz-form-label>
            <ul class="stages-list">
              <li *ngFor="let item of projectMembersList">
                <a href="mailto:{{item.emailId}}">
                  <nz-avatar class="m-r-10" [nzSrc]="item.userDetails && item.userDetails.profilePic ? item.userDetails.profilePic : ''" [nzShape]="'circle'" [nzSize]="'small'" [nzIcon]="'user'"></nz-avatar>
                <span>{{item.emailId}}</span>
                <div class="p-l-30 text-muted small" *ngIf="item.userDetails && item.userDetails.firstName">{{item.userDetails.firstName}} {{item.userDetails.lastName}}</div>
                </a>
<!--                <i (click)="removeCollaborators(item)" nz-icon nzType="close" theme="outline" class="float-right"></i>-->
              </li>
            </ul>
          </aside>
        </section>
      </ng-container>

      <!-- end collaborators -->
      <ng-container *ngIf="activeView.view==='stages'">

        <section class="row">

          <aside class="col-md-3">

            <form nz-form (submit)="addStage()" [formGroup]="stageForm">

              <nz-form-item>

                <nz-form-label>Stage title<span class="text-danger">*</span></nz-form-label>
                <nz-form-control>
                  <input nz-input statusListnzSize="small" formControlName="name" placeholder="Enter Stage title"
                         maxlength="30"/>
                </nz-form-control>

              </nz-form-item>

              <nz-form-item>
                <button nz-button nzType="primary" [nzLoading]="updateRequestInProcess" nzSize="small">Add</button>
              </nz-form-item>

            </form>

          </aside>

          <aside class="col-md-3">

            <nz-form-label>Default Stages</nz-form-label>

            <nz-spin nzTip="Loading..." [nzSpinning]="deleteStageInProcess">

              <ul class="stages-list">
                <li *ngFor="let item of stagesList"><span>{{item.name}}</span>
                  <i (click)="removeStage(item)" nz-icon nzType="close" theme="outline" class="close float-right"></i>
                </li>
              </ul>

            </nz-spin>

          </aside>

        </section>
      </ng-container>

      <!-- end stages -->

      <ng-container *ngIf="activeView.view==='status'">

        <section class="row">

          <aside class="col-md-3">

            <form nz-form (submit)="addStatus()" [formGroup]="statusForm">

              <nz-form-item>

                <nz-form-label>Status title<span class="text-danger">*</span></nz-form-label>
                <nz-form-control>
                  <input nz-input nzSize="small" formControlName="name" placeholder="Enter Status title"
                         maxlength="30"/>
                </nz-form-control>

              </nz-form-item>

              <nz-form-item>
                <button nz-button nzType="primary" [nzLoading]="updateRequestInProcess" nzSize="small">Add</button>
              </nz-form-item>

            </form>

          </aside>

          <aside class="col-md-3">

            <nz-form-label>Default Status</nz-form-label>

            <nz-spin nzTip="Loading..." [nzSpinning]="deleteStageInProcess">

              <ul class="stages-list">
                <li *ngFor="let item of statusList"><span>{{item.name}}</span>
                  <!--                  <i (click)="removeStatus(item)" nz-icon nzType="close" theme="outline" class="close float-right"></i>-->
                </li>
              </ul>

            </nz-spin>

          </aside>

        </section>
      </ng-container>

      <!-- end status -->
      <ng-container *ngIf="activeView.view==='priority'">

        <section class="row task-type-section">

          <aside class="col-md-3">

            <form nz-form (submit)="savePriority()" [formGroup]="priorityForm">

              <nz-form-item>
                <nz-form-label>Priority<span class="text-danger">*</span></nz-form-label>

                <nz-form-control>
                  <nz-input-group [nzAddOnBefore]="profixIconButton">
                    <input class="task-type-input" type="text" nzSize="small" formControlName="name" nz-input
                           placeholder="eg: Low"/>
                  </nz-input-group
                  >
                  <ng-template #profixIconButton>
                    <input type="color" nzSize="small" formControlName="color"/>
                  </ng-template>
                </nz-form-control>

              </nz-form-item>

              <nz-form-item>
                <button nz-button nzType="primary" [nzLoading]="updateRequestInProcess" nzSize="small">Add</button>
              </nz-form-item>

            </form>

          </aside>

          <aside class="col-md-3">

            <nz-form-label>Default Priorities</nz-form-label>

            <nz-spin nzTip="Loading..." [nzSpinning]="deleteTaskTypeInProcess">

              <ul class="stages-list">

                <li *ngFor="let item of priorityList">
                  <div [ngStyle]="{'border-left':'6px solid'+ item.color}" class="p-l-10"><span>{{item.name}}</span></div>
<!--                  <i (click)="removeTaskType(item)" nz-icon nzType="close" theme="outline" class="close float-right"></i>-->
                </li>

              </ul>

            </nz-spin>

          </aside>

        </section>
      </ng-container>

      <!-- end priority -->

      <ng-container *ngIf="activeView.view==='taskType'">

        <section class="row task-type-section">

          <aside class="col-md-3">

            <form nz-form (submit)="saveTaskType()" [formGroup]="taskTypeForm">

              <nz-form-item>
                <nz-form-label>Display name<span class="text-danger">*</span> <small>(as prefix with id eg : <b class="text-info">BUG-1001</b>)</small></nz-form-label>
                <nz-form-control>
                    <input class="task-type-input" type="text" nzSize="small" formControlName="displayName" nz-input placeholder="eg: BUG" maxlength="4" />
                </nz-form-control>
              </nz-form-item>
              <nz-form-item>
                <nz-form-label>Type<span class="text-danger">*</span></nz-form-label>

                <nz-form-control>
                  <nz-input-group [nzAddOnBefore]="profixIconButton">
                    <input class="task-type-input" type="text" nzSize="small" formControlName="name" nz-input
                           placeholder="Enter Task type"/>
                  </nz-input-group
                  >
                  <ng-template #profixIconButton>
                    <input type="color" nzSize="small" formControlName="color"/>
                  </ng-template>
                </nz-form-control>

              </nz-form-item>

              <nz-form-item>
                <button nz-button nzType="primary" [nzLoading]="updateRequestInProcess" nzSize="small">Add</button>
              </nz-form-item>

            </form>

          </aside>

          <aside class="col-md-3">

            <nz-form-label>Default Types</nz-form-label>

            <nz-spin nzTip="Loading..." [nzSpinning]="deleteTaskTypeInProcess">

              <ul class="stages-list">

                <li *ngFor="let item of typesList">
                  <i class="fas fa-circle m-r-10" [ngStyle]="{'color':item.color}"></i>
                  <span>{{item.name}}</span>
<!--                  <i (click)="removeTaskType(item)" nz-icon nzType="close" theme="outline" class="close float-right"></i>-->
                </li>

              </ul>

            </nz-spin>

          </aside>

        </section>
      </ng-container>

      <!-- end taskType -->


      <ng-container *ngIf="activeView.view==='capacity'">
        <aside class="col-md-4">
          <div class="capacity-table">
            <nz-table
              [nzData]="projectMembersList"
              [nzShowPagination]="false">
              <thead>
              <tr>
                <th width="30">#</th>
                <th class="text-left" colspan="2">Name</th>
                <th class="text-right" width="140">Working hours</th>
              </tr>
              </thead>
              <tbody>

              <tr *ngFor="let item of projectMembersList; let i = index;">
                <td>{{i+1}}.</td>
                <td><nz-avatar [nzSrc]="item.userDetails && item.userDetails.profilePic ? item.userDetails.profilePic : ''" [nzShape]="'circle'" [nzSize]="'small'" [nzIcon]="'user'"></nz-avatar></td>
                <td>
                  <span *ngIf="item.userDetails && item.userDetails.firstName">{{item.userDetails.firstName}} {{item.userDetails.lastName}}</span>
                  <div class="cap-email"><small class="text-muted">{{item.emailId}}</small></div>
                </td>
                <td class="text-right">
                  <input nz-input placeholder="Hours" numeric numericType="decimal" [(ngModel)]="item.workingCapacity" (keyup)="calculateTotal()" class="team-list-input" nzSize="small" maxlength="3"/>
                </td>
              </tr>
              <tr>
                <td class="text-right" colspan="4">Total Hours: {{totalCapacity}}</td>
              </tr>
              </tbody>
            </nz-table>
            <button (click)="saveCapacity()" [nzLoading]="updateRequestInProcess"  nz-button nzSize="small" nzType="primary">Save</button>
          </div>
        </aside>
      </ng-container>
      <!-- end team capacity-->

    </nz-card>
  </section>

</section>

