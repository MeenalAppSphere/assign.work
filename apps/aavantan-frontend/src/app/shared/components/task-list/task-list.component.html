<div class="container-fluid p-0">
    <div class="row" *ngIf="view == 'cardView'">
        <div class="col-md-3" *ngFor="let item of taskList">
            <nz-card nzSize="small">
                <div class="d-flex justify-content-between">
                    <div class="media">
                        <i *ngIf="item.priority && item.priority.color" [nzTitle]="item.priority.name" nz-tooltip [ngStyle]="{'margin-top': '2px','border-left':'solid 5px '+item.priority.color+'', 'height':'18px' }"></i>
                        <i *ngIf="!item.priority" [ngStyle]="{'border-left':'solid 5px #ffffff','margin-top': '4px', 'height':'18px' }"></i>
                        <i [ngStyle]="{'color': item.taskType.color}" [nzTitle]="item.taskType.name" nz-tooltip class="fas fa-circle m-l-5 m-t-5"></i>
                        <div class="m-l-10">
                            <h6 class="m-b-0">
                                <a href="javascript:void(0)" (click)="viewTask(item)">
                                    <p class="ellipsis">{{item.displayName}}: {{item.name}}</p>
                                </a>
                            </h6>
                        </div>
                    </div>
                </div>
                <p class="m-t-5 card-desc-height" nz-paragraph nzEllipsis nzEllipsisRows="3" [innerHTML]="item.description | safeHtml"></p>
                <p class=""><span>{{item.totalLoggedTime ? item.totalLoggedTime : 0 }}</span>hr
                    <a *ngIf="showLogOption" (click)="timeLog(item)" href="javascript:void(0);" class="float-right text-primary"><i nz-icon nzType="clock-circle" theme="outline"></i> Log Time</a>
                </p>
                <div *ngIf="showProgressOption && item.progress">
                    <div class="d-flex justify-content-between">
                        <span class="font-weight-semibold">Progress</span>
                        <span class="font-weight-semibold">{{item.progress}}%</span>
                    </div>
                    <nz-progress *ngIf="item.progress && item.status && item.status !== 'Behind'" [nzPercent]="item.progress" [nzShowInfo]="true" nzSize="small"></nz-progress>
                    <nz-progress *ngIf="item.progress && item.status && item.status == 'Behind'" [nzPercent]="item.progress" [nzShowInfo]="true" nzSize="small" nzStatus="exception"></nz-progress>
                </div>
                <div class="m-t-10">
                    <div class="d-flex justify-content-between align-items-center" style="min-height:24px;">
                        <div *ngIf="!item.status">-</div>
                        <div *ngIf="item.status">
                            <nz-tag class="m-b-0" *ngIf="item.status && item.status.name == 'In Progress'" [nzColor]="'blue'">{{item.status.name}}</nz-tag>
                            <nz-tag class="m-b-0" *ngIf="item.status && item.status.name !== 'Behind'" [nzColor]="'orange'">{{item.status.name}}</nz-tag>
                        </div>
                        <div *ngIf="!item.assignee">
                            <nz-avatar nzSize="small" nzIcon="user"></nz-avatar>
                        </div>
                        <div *ngIf="item.assignee">
                            <nz-avatar nzSize="small" nzIcon="user" [nzSrc]="item.assignee.profilePic" nz-tooltip [nzTitle]="item.assignee && item.assignee.firstName ? item.assignee.firstName : ''"></nz-avatar>
                            {{item.assignee && item.assignee.firstName ? item.assignee.firstName : item.assignee.emailId}}
                            <!--              <a routerLinkActive="router-link-active"  class="m-r-5" *ngFor="let item of (item.assignee ? item.assignee.slice(0,2): [])">-->
                            <!--                <nz-avatar  nzSize="small" [nzSrc]="item.profilePic" nz-tooltip [nzTitle]="item.firstName"></nz-avatar>-->
                            <!--              </a>-->
                            <!--              <a *ngIf="item.assignee.length > 2">-->
                            <!--                <nz-avatar class="font-size-11 text-dark" nzSize="small" [nzText]="'+' + [item.assignee.length - 2].toString()" nz-tooltip [nzTitle]="[item.assignee.length - 2].toString() + ' More'"></nz-avatar>-->
                            <!--              </a>-->
                        </div>
                    </div>
                </div>
            </nz-card>
        </div>
    </div>

    <nz-table #listViewTable [nzData]="taskList" *ngIf="view == 'listView'" nzSize="small">
        <thead>
            <tr>
                <th class="text-center" width="20" *ngIf="showCheckboxOption">#</th>
                <th class="text-left" width="90">
                  <span>Priority</span>
                  <span class="p-l-10">
                    <ng-container *ngTemplateOutlet="sortTemplate;context: {column: 'priority'}"></ng-container>
                  </span>
                </th>
                <th>
                  <span>Title/Task Type</span>
                  <span class="p-l-10">
                    <ng-container *ngTemplateOutlet="sortTemplate;context: {column: 'name'}"></ng-container>
                  </span>
                </th>
                <th class="text-center" *ngIf="showProgressOption">Progress</th>
                <th class="text-center">
                  <span>Status</span>
                  <span class="p-l-10">
                    <ng-container *ngTemplateOutlet="sortTemplate;context: {column: 'status'}"></ng-container>
                  </span>
                </th>
                <th class="text-left">Member</th>
                <th class="text-right">Estimate<span *ngIf="showLogOption">/Log Time</span></th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let item of listViewTable.data">
                <td data-label="#" *ngIf="showCheckboxOption" class="text-center">
                    <label nz-checkbox [(ngModel)]="item.isSelected" (nzCheckedChange)="selectTaskForSprint(item)"></label>
                </td>

                <td data-label="Priority" class="text-left">
                  <i *ngIf="item.priority && item.priority.color" [ngStyle]="{'border-left':'solid 5px '+item.priority.color+'', 'height':'18px' }"></i>
                  <i *ngIf="!item.priority" [ngStyle]="{'border-left':'solid 5px #ffffff', 'height':'18px' }"></i>
                  <span class="p-l-5">{{item.priority && item.priority.name ? item.priority.name : '-'}}</span>
                </td>

                <td data-label="Title" style="width:50%;">
                    <div class="media align-items-center">
                        <i [ngStyle]="{'color': item.taskType.color}" [nzTitle]="item.taskType.name" nz-tooltip class="fas fa-circle m-l-5"></i>
                        <div class="m-l-10">

                            <h6 class="m-b-0">
                                <p class="m-0" style="max-width: 500px;" nz-paragraph nzEllipsis [nzEllipsisRows]="1">
                                    <a href="javascript:void(0)" (click)="viewTask(item)">
                    {{item.displayName}}: {{item.name}}
                  </a>
                                </p>
                            </h6>

                        </div>
                    </div>
                </td>
                <td *ngIf="showProgressOption" data-label="Progress" class="text-center">
                    <span *ngIf="!item.progress">-</span>
                    <nz-progress *ngIf="item.progress>0" [nzPercent]="item.progress" [nzShowInfo]="true" nzSize="small"></nz-progress>
                    <nz-progress *ngIf="item.progress === 0" [nzPercent]="item.progress" [nzShowInfo]="true" nzSize="small" nzStatus="exception"></nz-progress>
                </td>
                <td data-label="Status" class="text-center">
                    <span *ngIf="!item.status">-</span>
                    <nz-tag class="m-b-0" *ngIf="item.status && item.status && item.status.name === 'In Progress'" [nzColor]="'green'">{{item.status.name}}</nz-tag>
                    <nz-tag class="m-b-0" *ngIf="item.status && item.status && item.status.name !== 'In Progress'" [nzColor]="'orange'">{{item.status.name}}</nz-tag>
                </td>
                <td data-label="Members" class="text-left">
                    <span *ngIf="!item.assignee">-</span>
                    <span *ngIf="item.assignee"> <nz-avatar nzSize="small" nzIcon="user" class="m-r-5" [nzSrc]="item.assignee.profilePic" nz-tooltip [nzTitle]="item.assignee && item.assignee.firstName ? item.assignee.firstName : ''"></nz-avatar>{{item.assignee && item.assignee.firstName ? item.assignee.firstName : item.assignee.emailId}}</span>

                    <!--          <a routerLinkActive="router-link-active"  class="m-r-5" *ngFor="let itm of (item.assignee ? item.assignee.slice(0,2): [])">-->
                    <!--            <nz-avatar  nzSize="small" [nzSrc]="itm.profilePic" nz-tooltip [nzTitle]="itm.firstName"></nz-avatar>-->
                    <!--            <span *ngIf="item.assignee.length===1" class="m-l-5">{{itm.firstName}}</span>-->
                    <!--          </a>-->
                    <!--          <a *ngIf="item.assignee.length > 2">-->
                    <!--            <nz-avatar class="font-size-11 text-dark" nzSize="small" [nzText]="'+' + [item.member.length - 2].toString()" nz-tooltip [nzTitle]="[item.assignee.length - 2].toString() + ' More'"></nz-avatar>-->
                    <!--          </a>-->
                </td>
                <td data-label="Estimate" class="text-right">
                    <span>{{item.totalLoggedTime ? item.totalLoggedTime : 0 }}</span>hr&ensp;<a href="javascript:void(0);" class="float-right text-primary" *ngIf="showLogOption" (click)="timeLog(item)"><i nz-icon nzType="clock-circle" theme="outline"></i> Log Time</a>
                </td>
            </tr>
        </tbody>
    </nz-table>
</div>


<!-- sorting icon template -->
<ng-template #sortTemplate let-column="column">

  <i class="fas fa-long-arrow-alt-up" *ngIf="sortingRequest.sortBy !== column" (click)="sortButtonClicked('asc', column)" [ngClass]="{'text-info': sortingRequest.sortBy === column && sortingRequest.sort === 'asc'}"></i>

  <i class="fas fa-long-arrow-alt-up" *ngIf="sortingRequest.sortBy === column && sortingRequest.sort === 'asc'" (click)="sortButtonClicked('desc', column)" [ngClass]="{'text-info': sortingRequest.sortBy === column && sortingRequest.sort === 'asc'}"></i>

  <i class="fas fa-long-arrow-alt-down" *ngIf="sortingRequest.sortBy === column && sortingRequest.sort === 'desc'" (click)="sortButtonClicked('asc', column)" [ngClass]="{'text-info': sortingRequest.sortBy === column && sortingRequest.sort === 'desc'}"></i>

</ng-template>
<!-- sorting -->

<app-timelog [timelogModalIsVisible]="timelogModalIsVisible" [selectedTaskItem]="selectedTaskItem" (toggleTimeLogShow)="timeLog(selectedTaskItem)"></app-timelog>
