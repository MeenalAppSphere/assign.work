<section class="collaborators-avatar">
  <div class="row">

    <div class="col">

      <button nzType="primary" nzSize="small" class="p-l-10 p-r-10 sprint-button" nz-button>{{activeSprintData && activeSprintData.name ? activeSprintData.name : 'Sprint'}}</button>

<!--   once we allow multiple sprint   -->
<!--      <nz-button-group nz-dropdown [nzDropdownMenu]="changeSprintTemplate" nzPlacement="bottomLeft">-->
<!--        <button nzType="primary" nzSize="small" class="p-l-10 p-r-10 sprint-button" nz-button>{{sprintData.name}}-->
<!--          <img src="../../../assets/images/icons/arrow-point-to-down.svg" class="p-l-10" height="5"/>-->
<!--        </button>-->
<!--      </nz-button-group>-->
<!--      <nz-dropdown-menu #changeSprintTemplate="nzDropdownMenu">-->
<!--        <ul nz-menu>-->
<!--          <li nz-menu-item *ngFor="let item of sprintDataSource">{{item.name}}</li>-->
<!--        </ul>-->
<!--      </nz-dropdown-menu>-->

    </div>
    <div class="col text-right">
      <span *ngIf="boardData && boardData.membersCapacity?.length>0">
        <nz-avatar *ngFor="let item of boardData.membersCapacity" nzText="{{(item.user && item.user.firstName ? item.user.firstName : item.user.emailId) | slice : 0:1}}" nzSize="" nzTitle="{{item.user.firstName}}" nzPlacement="top" nz-tooltip class="bg-info"></nz-avatar>

<!--        <nz-avatar nzIcon="user" nzSize="" nzTitle="Pradeep" nzPlacement="top" nz-tooltip nzSrc="//zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png"></nz-avatar>-->
<!--        <nz-avatar nzIcon="user" class="active-avatar" nzSize="" nzTitle="Sameer" nzPlacement="top" nz-tooltip nzSrc="//zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png"></nz-avatar>-->
<!--        -->
      </span>
      <button nzType="primary" nzSize="small" nz-button class="btn-add-task m-l-30">+ Add Task</button>
    </div>

  </div>
</section>

<nz-spin nzTip="Getting Board Data..." [nzSpinning]="getStageInProcess">
  <div class="sprintboard-container">
    <div class="container-fluid">
      <div class="row flex-row flex-nowrap" *ngIf="boardData && boardData.stages && boardData.stages.length>0">
        <div class="column" joyrideStep="board" title="Board" text="Board" *ngFor="let item of boardData.stages; let last">
          <div class="card card-block">
            <div class="card-header">{{item.stage.name}} <span class="pull-right"><i class="pl-3 fa fa-ellipsis-v"></i></span>
              <div class="pull-left" style="line-height: 10px;">
              <small class="text-muted font-size-10">Total hours&nbsp;</small>&nbsp;
                <span class="font-size-12">{{item.totalEstimationReadable}}</span>
              </div>
            </div>

            <bs-sortable id="{{item.stage.id}}" (dragend)="moveTask($event, item.stage.id)" [(ngModel)]="item.tasks" [itemTemplate]="itemTemplate" itemClass="sortable-item" itemActiveClass="sortable-item-active" placeholderItem="Drag here to move the items" placeholderClass="placeholderStyle" wrapperClass="sortable-wrapper" class="card-body">
            </bs-sortable>

          </div>
        </div>
      </div>
      <div *ngIf="!boardData" class="text-center text-gray-light">
        <nz-empty
          [nzNotFoundImage]="false"
          [nzNotFoundContent]="contentTpl"
          [nzNotFoundFooter]="footerTpl">
          <ng-template #contentTpl>
            <span>There in no active Sprint</span>
          </ng-template>
          <ng-template #footerTpl>
            <button nz-button nzSize="small" nzType="primary" class="btn-medium" routerLink="../backlog">+ Create Sprint</button>
          </ng-template>
        </nz-empty>
      </div>
    </div>
  </div>

  <ng-template #itemTemplate let-item="item" let-index="index">
    <div id="{{item.value.id}}" class="task-card" [ngStyle]="{'border-left': '4px solid '+ item.value.task.priority.color}">
      <h6 [ngStyle]="{'color': item.value.task.taskType.color}">#{{item.value.task.displayName}}
        <span class="float-right duration">{{item.value.task.createdAt | dateAgo }}</span>
      </h6>
      <div class="task-body">
        <div>
        <a href="" class="task-title">
          {{item.value.task.name}}
        </a>
        </div>
      </div>
      <div class="task-footer">
        <span><nz-avatar class="m-r-5" nzIcon="user" nzSrc="{{item.value.task.assignee.profilePic}}" nzShape="circle"></nz-avatar><span class="profile-name">{{item.value.task.assignee.firstName}}</span></span>
        <span class="pull-right"> <a (click)="timeLog(item.value.task)" href="javascript:void(0);" class="text-primary"><i nz-icon nzType="clock-circle" theme="outline"></i> Log Time</a></span>
      </div>
    </div>
  </ng-template>
</nz-spin>
<app-timelog [timelogModalIsVisible]="timelogModalIsVisible" [selectedTaskItem]="selectedTaskItem" (toggleTimeLogShow)="timeLog(selectedTaskItem)"></app-timelog>

